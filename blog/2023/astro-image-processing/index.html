<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>astro image processing | ravi kumar</title> <meta name="author" content="ravi kumar"> <meta name="description" content="learn some basic processing techniques for deep sky images - using Siril."> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?00c0fca4abe040a263d309dc48a0d0c0"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ravioli1369.github.io/blog/2023/astro-image-processing/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">ravi </span>kumar</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">projects<span class="sr-only">(current)</span></a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">photography</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/portrait/">portrait</a> <a class="dropdown-item" href="/nature/">nature</a> <a class="dropdown-item" href="/random/">random</a> <a class="dropdown-item" href="/events/">events</a> <a class="dropdown-item" href="/astrophotography/">astrophotography</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">astro image processing</h1> <p class="post-meta">May 15, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/photography"> <i class="fas fa-hashtag fa-sm"></i> photography</a>   <a href="/blog/tag/astrophotography"> <i class="fas fa-hashtag fa-sm"></i> astrophotography</a>   <a href="/blog/tag/editing"> <i class="fas fa-hashtag fa-sm"></i> editing</a>   <a href="/blog/tag/tutorial"> <i class="fas fa-hashtag fa-sm"></i> tutorial</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="using-siril"><strong>Using Siril</strong></h1> <p><a href="https://siril.org/" rel="external nofollow noopener" target="_blank">Siril</a> is an open-source software application for astrophotography, which allows pre-processing and processing of images from any type of camera. This is a very powerful software that allows you to get away with stacking, extracting the background, stretching, color calibration, and much more, all for free, not to mention that it’s available on Windows, MacOS, and Linux. Kinda makes it the perfect app for astro-image processing.</p> <p>To get started, first download Siril using the link provided above and install it. In the realm of amateur astrophotography, we don’t always have the luxury of being able to capture all our calibration frames, be it due to time constraints or just being too tired after a long night of imaging. The default “scripts” Siril provides require that all the calibration frames be present, but there are <a href="https://free-astro.org/index.php?title=Siril:scripts" rel="external nofollow noopener" target="_blank">additional scripts</a> available. Following the instructions provided in the siril:scripts site, we can now begin to process images without all calibration frames, BUT just because we <em>can</em> process without calibration frames <em>does not</em> mean we give up capturing those frames entirely.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/siril_step1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/siril_step1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/siril_step1-1400.webp"></source> <img src="/assets/img/siril_step1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> The first step one must do before anything is organizing all your files in folders, namely "lights", "darks", "biases" and "flats". All these folders must lie within the same common folder, additionally, the names of the folders <i>must</i> be the same as mentioned above. Now, we can change our working directory to this common folder by pressing the little home icon at the top left next to the "Open" button and navigating to our folder containing subfolders of our images. </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> Now, click on the "Scripts" tab to reveal a list of scripts. If you have imported the additional scripts mentioned earlier then you should see them in the dropdown as shown on the left. All that's left is to run the correct script according to the data we have. For example, we run the "OSC_preprocessing_WithoutDark" if we are missing dark frames and processing a color RGB image, and we run "Mono_Preprocessing_WithoutFlat" for processing monochrome images without flat frames and so on. <br> <br> A thing to note is that once the script is running, it <i>can and will</i> take up large amounts of hard-disk space in a folder it creates called "process". This folder can be deleted once the final image "result.fit" is produced. It is imperative that you don't disturb the process of the script running, additionally, your device may become unresponsive during the process; best to leave it be and return once it's done stacking (should take anywhere between a couple of minutes to half an hour or longer depending on the number of images and processing capabilities of your device). </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/siril_step2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/siril_step2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/siril_step2-1400.webp"></source> <img src="/assets/img/siril_step2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br> Following the above steps <em>should</em> (no promises) lead to a “results.fit” file in the same folder containing the folders of all your files. If the script fails for whatever reason, then Siril will provide reasons for the same. Additionally you can follow the guide to <a href="https://siril.org/tutorials/tuto-manual/" rel="external nofollow noopener" target="_blank">manual pre-processing</a> written by Siril.</p> <p>Now we can move on to importing the result.fit file back into Siril by using the “Open” button in the top left corner and navigating to the file. You <em>should</em> (not always the case, it’s possible to see the structure of extremely bright objects like Orion’s Nebula) see a completely pitch-black image with just a few stars poking out of it. Nothing to panic about, this is completely natural and is a direct result of the stacking process.</p> <p>The data in our image is “compressed” into a very small region, which is why we mostly see black. We’ve gotta “stretch” our data in order to see the vast amount of detail that would otherwise be hidden, but before that, some changes to the image must be made.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/siril_step3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/siril_step3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/siril_step3-1400.webp"></source> <img src="/assets/img/siril_step3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> Start by first changing the data from a "linear" view to an "autostretch" view. Basically, Siril will stretch the image for us to show a rough idea of the data we are working with so that we can make changes like color calibration, background extraction, etc. This "autostretch" always overexaggerates the image and is quite unrefined. Click on the "Linear" toggle at the bottom and select autostretch and watch the magic happen. You'll go from an almost black image to revealing all the details of the target you've captured. Quite a dramatic but fun thing to watch. This can help show how usable your data actually is before you go through the tedious process of stretching it manually and finding a screw-up in the stacking or capturing phase. </div> </div> <p>Now onto the main changes to be made to the data: cropping, color calibration, and background extraction. With color calibration, the colors of the sky and objects are tweaked to make them more realistic. Background extraction samples the background at many places in the image and looks for a trend in the variations and removes it following a smoothed function to avoid removing nebulae with it.</p> <p>The image should look black and white at this stage and this is because we are seeing the “Red” color channel of the image. In other words, you’re just seeing the data collected by the pixels that gather red light. Similarly, there’s a “Green” and “Blue” channel next to the red channel, all of them being below the “Open” button.</p> <p>Let’s start by cropping the image to remove artifacts near the edges which may be caused by the stacking process. Siril themselves have a great tutorial on these first few steps. For this step, you can follow their tutorial on <a href="https://siril.org/tutorials/tuto-scripts/#first-operation-cropping-the-image" rel="external nofollow noopener" target="_blank">cropping</a>.</p> <p>Now we can perform <a href="https://siril.org/tutorials/tuto-scripts/#removing-background-gradient" rel="external nofollow noopener" target="_blank">background extraction</a> again by following Siril’s guide. Once this is done, we can move on to looking at the “RGB” channel of the image only to find an image that’s completely green, blue, magenta, or any other color that doesn’t represent the sky or the target. This is completely normal and happens due to the white balance setting while taking the image.</p> <p>Once again, we follow the tutorial on Siril’s site and proceed with <a href="https://siril.org/tutorials/tuto-scripts/#colour-calibration-using-photometry" rel="external nofollow noopener" target="_blank">color calibration</a>, however, Siril has used photometric color calibration, a technique that requires you to “plate solve” your image by entering the target you’ve imaged along with telescope and camera details (namely focal length and pixel size). Siril uses this information and detects the stars present in the image and compares the color of those stars to a catalog of known colors and adjusts the colors of the image to best match this catalog. Often this produces great results, but in the case that the plate solve fails, we have to resort to manual color calibration.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> The manual color calibration is just above the photometric color calibration in the dropdown menu. Upon clicking it, we are presented with a popup as shown to the side. For the background reference, select any area on the image that is devoid of many stars, then click on "Use current selection" near the top of the popup. Now click the blue button saying "Background Neutralisation" and that should fix the colors of the image for the most part. Now zoom (Ctrl/Cmd+scroll) into the core of a white star and select another region and follow the same steps. Now click apply.<br> <br> Note that you have to go back to any one of the Red, Green, or Blue channels to make selections on the image. </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/siril_step4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/siril_step4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/siril_step4-1400.webp"></source> <img src="/assets/img/siril_step4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <iframe width="450" height="250" src="https://www.youtube.com/embed/rFDwGnUwOh8?si=WrhG4AD15xW4ujdW" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> </div> <div class="col-sm mt-3 mt-md-0"> The actual process of stretching is frankly too long to be covered in the form of a guide like this, so I've attached a video that explains a powerful method of stretching that can be done with Siril. Only about half of the video is relevant, just the stretching part, StarNet++ functionality can be ignored for now.<br> <br> You can and should perform additional functions like noise reduction, median filter, etc in Siril itself. Play around with the settings to see what works best, there are limitless possibilities. </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> Once you've stretched the image and are happy with how it looks, you can export the image by clicking on the down arrow next to the "Save" button near the top right corner. You can choose the file type it saves just by changing the extension at the end. Common file types are .jpg and .png, although .png is preferred due to its higher quality. </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/siril_step5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/siril_step5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/siril_step5-1400.webp"></source> <img src="/assets/img/siril_step5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="processing-mono-images"><strong>Processing Mono Images</strong></h2> <p>The above guide showed the steps involved in processing a One Shot Color (OSC) image, i.e. an RGB image where the Red, Green, and Blue channels are already part of the image data. However, the typical astrophotography camera has a monochrome (black and white) sensor in order to collect more data in each channel.</p> <p>Filters are used in front of the sensor to isolate various frequencies of light and effectively creates an image for each “channel” of the final image to be produced. 3 separate images are taken, each with a different filter to isolate different frequencies of light and they are mapped to their corresponding colors in software.</p> <p>Common filters that are used are the Sulphur II, Oxygen III, Hydrogen-alpha, and Hydrogen-beta filters that isolate frequencies of light corresponding to the atom’s spectral emissions.</p> <p>The stacking part of mono images remains unchanged from the regular OSC images, the only change being that we have to use the scripts labelled “Mono_”. Once the stacking is complete we <strong>do not</strong> need to perform anything on it and save the files according to the filter being used. Once all 3 or however many images are stacked and the files are correctly named and saved, we can go onto combine the images.</p> </div> </article><div id="giscus_thread" style="max-width: 69%; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"ravioli1369/ravioli1369.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-2DW1B1CSQ0"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2DW1B1CSQ0");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>